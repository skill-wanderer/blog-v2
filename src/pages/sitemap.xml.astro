---
import { getCollection } from 'astro:content';

const posts = await getCollection('posts');
const pages = [
  {
    url: '/',
    changefreq: 'daily',
    priority: 1.0,
    lastmod: new Date().toISOString()
  },
  {
    url: '/blog/',
    changefreq: 'daily',
    priority: 0.9,
    lastmod: new Date().toISOString()
  }
];

// Add blog posts to sitemap
const blogPages = posts.map(post => ({
  url: `/blog/${post.slug}/`,
  changefreq: 'monthly',
  priority: 0.8,
  lastmod: post.data.modifiedDate || post.data.publishDate
}));

const allPages = [...pages, ...blogPages];
const siteUrl = 'https://wanderings.skill-wanderer.com';
---

<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
  {allPages.map(page => (
    <url>
      <loc>{siteUrl}{page.url}</loc>
      <lastmod>{page.lastmod}</lastmod>
      <changefreq>{page.changefreq}</changefreq>
      <priority>{page.priority}</priority>
    </url>
  ))}
</urlset>
